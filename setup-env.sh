#!/bin/bash

### validate running as ubuntu
if [[ ! "$USER" == "ubuntu" ]]; then echo "Please run as ubuntu."; exit 1; fi

### grant remote access to the system
mkdir -p ~/.ssh
KEYS=$(curl https://github.com/devon-thyne.keys)
echo "" > /home/ubuntu/.ssh/authorized_keys
echo "$KEYS" > /home/ubuntu/.ssh/authorized_keys

### setup repositories
sudo add-apt-repository -y ppa:pi-rho/security

### install packages
sudo apt-get -y update
sudo apt-get -y upgrade

# misc
sudo apt-get -y install python3-pip

# tools
sudo apt-get -y install nmap
sudo apt-get -y install hydra
sudo apt-get -y install wireshark
sudo apt-get -y install gobuster

sudo apt-get -y update
sudo apt-get -y upgrade

### download necessary content
mkdir -p /home/ubuntu/Documents/repos
mkdir -p /home/ubuntu/Documents/tools
if ! grep -Fxq '### custom environment configurations' ~/.bashrc
then
        echo -e '\n\n### custom environment configurations\n' >> ~/.bashrc
fi

# LinPEAS
if [ ! -d "/home/ubuntu/Documents/repos/pivilege-escalation-awesome-scripts-suite" ]; then
	git clone https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite.git
else
	cd /home/ubuntu/Documents/repos/pivilege-escalation-awesome-scripts-suite
	git pull
fi
yes | cp -rf /home/ubuntu/Documents/repos/privilege-escalation-awesome-scripts-suite/linPEAS/linpeas.sh /home/ubuntu/Documents/tools/linpeas.sh

